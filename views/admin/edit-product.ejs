<%- include('../layouts/adminheader.ejs') %>

<div class="wrapper">
    <div class="sidebar" data-background-color="white" data-active-color="warning">
        <div class="sidebar-wrapper">
            <div class="logo">
                <img src="/assets/images/icons/logo-01.png" alt="">
                <strong style="font-size: 200%;">SpecsMakers</strong>
              </div>
  
            <ul class="nav">
                <li>
                    <a href="/admin/">
                        <i class="ti-panel"></i>
                        <p>Dashboard</p>
                    </a>
                </li>
             
                <li>
                    <a href="adminUser">
                        <i class="ti-view-list-alt"></i>
                        <p>Users List</p>
                    </a>
                </li>
                <li class="active">
                    <a href="adminProduct">
                        <i class="ti-view-list-alt"></i>
                        <p>Product</p>
                    </a>
                </li>
                <li>
                    <a href="adminOrder">
                        <i class="ti-pencil-alt2"></i>
                        <p>Order</p>
                    </a>
                </li>
                <li>
                    <a href="admin-category">
                        <i class="ti-map"></i>
                        <p>category</p>
                    </a>
                </li>
                <li  >
                    <a href="/admin/loadBanners">
                        <i class="ti-map"></i>
                        <p>Banners</p>
                    </a>
                </li>
                <li>
                  <a href="admin-offer">
                      <i class="ti-bell"></i>
                      <p>Offer</p>
                  </a>
              </li>
              <li>
                <a href="/admin/salesReport">
                    <i class="ti-download"></i>
                    <p>Product List</p>
                </a>
              </li>
              <li>
                <a href="/admin/adminlogout"
                  ><i class="fa fa-power-off m-r-5 m-l-5"></i>LOGOUT</a
                >
              </li>
                
            </ul>
            
        </div>
    </div>
    <div class="main-panel">
  <form action="/admin/edit-product" method="post" class="my-auto" style="height: 90vh;" enctype="multipart/form-data">
      <div class="container h-100 ">
          <div class="row d-flex justify-content-center align-items-center h-100">
              <div class="col-lg-12 col-xl-11">
                  <div class="card bg-transparent" style="border-radius: 25px;">
                      <div class="card-body p-md-2">
                          <div class="row justify-content-center " style="margin-top: 5%; display: flex;justify-content: center;">
                              <div class="col-md-2 col-lg-6 col-xl-5 order-2 order-lg-1 width-50">
                                  <p class="text-center h1 fw-bold mb-5 mx-1 mx-md-4 mt-4">Edit<span class="text-main-1">Product</span></p>
  
                                  <form class="mx-1 mx-md-2">
        
                                      <div class="d-flex flex-row align-items-center mb-2">
                                        
                                        <div class="form-outline flex-fill mb-0">
                                          <label class="form-label" for="form3Example1c">Name</label>
                                          <input type="text" id="form3Example1c" class="form-control" name="gName" value="<%= product.name %>" required/>
                                          
                                        </div>
                                      </div>
                    
                                      <div class="d-flex flex-row align-items-center mb-2">
                                        
                                        <div class="form-outline flex-fill mb-0">
                                          <label class="form-label" for="form3Example3c">Stock</label>
                                          <input type="number" id="form3Example3c" class="form-control" name="gQuantity" value="<%= product.quantity %>" required/>
                                          
                                        </div>
                                      </div>
                    
                                      <div class="d-flex flex-row align-items-center mb-2">
                                         
                                          <div class="form-outline flex-fill mb-0">
                                              <label class="form-label" for="form3Example1c">Price</label>
                                            <input type="number" id="form3Example1c" class="form-control" name="gPrice" value="<%= product.price %>" required/>
                                            
                                          </div>
                                        </div>
              
                                      <div class="d-flex flex-row align-items-center mb-2">
                                       
                                        <div class="form-outline flex-fill mb-0">
                                          <label class="form-label" for="form3Example4c">Description</label>
                                          <input type="text" id="form3Example4c" class="form-control" name="gDescription"  value="<%= product.description %>" required/>
                                          
                                        </div>
                                      </div>
  
                                      <div class="d-flex flex-row align-items-center mb-2">
                                         
                                        <div class="form-outline flex-fill mb-0">
                                            <label class="form-label" for="form3Example1c">Rating</label>
                                          <input type="number" id="form3Example1c" class="form-control" name="gRating" value="<%= product.rating %>"  max="5" required/>
                                          
                                        </div>
                                      </div>
  
                                     
                                      <div class="d-flex flex-row align-items-center mb-2">
                                        <div class="form-outline flex-fill mb-0">
                                          <label class="form-label" for="form3Example1c">Category</label>
                                        <input type="text" id="form3Example1c" class="form-control" name="genre" value="<%= product.genre %>"  required/>
                                        
                                      </div>
                                      </div>
                                      <div class="d-flex flex-row align-items-center mb-4">
                                          <div class="form-outline flex-fill mb-0">
                                            <label class="form-label" for="form3Example4c">Image</label> <br>
                                            <div  style="display: flex;">
                                            <% for(let key of product.image) {%>
                                              <div class="img-wrap" id="<%=key%>">
                                                <button class="close delete-btn" onclick="del('<%=key%>')">
                                                    &times;
                                                </button>
                                                <img src="/assets/uploads/<%=key%>" alt="" width="100px" height="80px" class="img-thumbnail">
                                            </div>
                                            <% } %>
                                          </div>
                                            <input type="file" id="form3Example4c" class="form-control" name="gImage" accept="image/*" o00000 multiple />
                                          </div>
                                        </div>
                                      <div class="d-flex justify-content-center mx-4 mb-3 mb-lg-4 " style="padding-top: 5%;padding-bottom: 5%;">
                                          <input type="hidden" name="id" value="<%= product._id %>">
                                        <button  type="submit" value="Register" class="btn btn-primary btn-lg">Save Edits</button>
                                        <a href="/admin/view-product" class="btn btn-primary ml-2 btn-lg">Go Back</a>
                                      </div>
              
                                      <% if(typeof message !== 'undefined'){%>
                                          <p style="color:green"><%= message %></p>
                                      <% } %>
                                      
                                      <input type="hidden" id="pid" value="<%=product._id%>">

                                    </form>
                              </div>
                          </div>
                      </div>
                  </div>
          </div>
      </div>
  </form>
  </div>
  </div>

<script>
  const productid=document.getElementById('pid').value 
  console.log(productid);
  function del(id){
    document.getElementById(id).innerHTML=''
    itemId=productid
    imageName=id
    $.ajax({
      url:'/admin/deletesingleimage',
      type:'POST',
      data:{imageName,itemId},
      success:function(response){
        
      }
    })
  }
</script>


  <%-include('../layouts/adminfooter.ejs') %>